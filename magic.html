<html>
<head></script>

<style>
td {
  padding: 15px;
}
</style>
</head>
<body>

<table><tr><td width=150>
<input type="checkbox" class="boxed" value="Blue" checked><img width=12 src="icons/U.png">Blue<br>
<input type="checkbox" class="boxed" value="Red" checked><img width=12 src="icons/R.png">Red<br>
<input type="checkbox" class="boxed" value="Black" checked><img width=12 src="icons/B.png">Black<br>
<input type="checkbox" class="boxed" value="White" checked><img width=12 src="icons/W.png">White<br>
<input type="checkbox" class="boxed" value="Green" checked><img width=12 src="icons/G.png">Green
</td><td width=150>
<input type="checkbox" class="boxed" value="Creature" checked><img width=12 src="icons/Creature_symbol.png">Creature<br>
<input type="checkbox" class="boxed" value="Sorcery" checked><img width=12 src="icons/Sorcery_symbol.png">Sorcery<br>
<input type="checkbox" class="boxed" value="Instant" checked><img width=12 src="icons/Instant_symbol.png">Instant<br>
<input type="checkbox" class="boxed" value="Enchantment" checked><img width=12 src="icons/Enchantment_symbol.png">Enchantment<br>
<br>
</td><td width=150>
<input type="checkbox" class="boxed" value="Common" checked><img width=12 src="icons/common.svg">Common<br>
<input type="checkbox" class="boxed" value="Uncommon" checked><img width=14 src="icons/uncommon.svg">Uncommon<br>
<input type="checkbox" class="boxed" value="Rare" checked><img width=16 src="icons/rare.svg">Rare<br>
<input type="checkbox" class="boxed" value="Mythical" checked><img width=18 src="icons/mythic.svg">Mythic<br>
<br>
</td></tr></table>

<h1>DANK NEW CARDS HOT OFF THE BOOSTER PACK</h1>

<button onclick="crunked()">Booster Pack</button>
<button onclick="hookup()">Single Draw</button>
<button onclick="refresh()">Clear table</button>

<table><tr><td padding=15>
<div id="logged"></div>
</td><td padding=15>
<div id="content"></div>
</td></tr></table>


<script defer src="scripts/cards.js"></script>
<script>

    var newData1 = [];
	var newData2 = [];
	var counter = 0;
	var packlog = "";
	var newpack = [];
	var choices = [];

function shuffle(array) {
  let currentIndex = array.length,  randomIndex;

  // While there remain elements to shuffle.
  while (currentIndex != 0) {

    // Pick a remaining element.
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }

  return array;
}

	function getchecks(){
		choices = [];
		var checkboxes = document.querySelectorAll('input[type=checkbox]:checked')
			for (var i = 0; i < checkboxes.length; i++) {
				choices.push(checkboxes[i].value)
		}
	}
  
	function refresh(){
		getchecks();

        newData1 = testfirst.filter(function(d,i){return choices.includes(d[1]);});
        newData1 = newData1.filter(function(d,i){return choices.includes(d[2]);});
        newData1 = newData1.filter(function(d,i){return choices.includes(d[3]);});
        newData2 = testlast.filter(function(d,i){return choices.includes(d[1]);});
        newData2 = newData2.filter(function(d,i){return choices.includes(d[2]);});
        newData2 = newData2.filter(function(d,i){return choices.includes(d[3]);});
        
		newData1 = shuffle(newData1);
		newData2 = shuffle(newData2);
		counter = 0;
		newpack = [];
		packdisplay = "";
		document.getElementById('content').innerHTML = ``;
		document.getElementById('logged').innerHTML = ``;
	}

	function rtest(a,b){
		if(a[1][3]=="Mythical" && b[1][3]!="Mythical") return -1;
		if(a[1][3]=="Rare" && b[1][3]!="Mythical" && b[1][3]!= "Rare") return -1;
		if(a[1][3]=="Uncommon" && b[1][3]=="Common") return -1;

		if(b[1][3]=="Mythical" && a[1][3]!="Mythical") return 1;
		if(b[1][3]=="Rare" && a[1][3]!="Mythical" && b[1][3]!= "Rare") return 1;
		if(b[1][3]=="Uncommon" && a[1][3]=="Common") return 1;
	}

	function iget(x){
		var results = "";

		if(x[1]=="Black") {results+='<img width=20 src="icons/B.png"> '; }
		else if(x[1]=="Red") {results+='<img width=20 src="icons/R.png"> '; }
		else if(x[1]=="White") {results+='<img width=20 src="icons/W.png"> '; }
		else if(x[1]=="Green") {results+='<img width=20 src="icons/G.png"> '; }
		else if(x[1]=="Blue") {results+='<img width=20 src="icons/U.png"> '; }

		if(x[2]=="Creature") {results+='<img width=18 src="icons/Creature_symbol.png"> '; }
		else if(x[2]=="Enchantment") {results+='<img width=18 src="icons/Enchantment_symbol.png"> '; }
		else if(x[2]=="Sorcery") {results+='<img width=15 src="icons/Sorcery_symbol.png"> '; }
		else if(x[2]=="Instant") {results+='<img width=15 src="icons/Instant_symbol.png"> '; }

		if(x[3]=="Common") {results+='<img width=15 src="icons/common.svg"> '; }
		else if(x[3]=="Uncommon") {results+='<img width=18 src="icons/uncommon.svg"> '; }
		else if(x[3]=="Rare") {results+='<img width=21 src="icons/rare.svg"> '; }
		else if(x[3]=="Mythical") {results+='<img width=24 src="icons/mythic.svg"> '; }

		return results;

	}

	function mget(x){
		var results = "";

		if(x==0) {results+='<img width=10 src="icons/0.svg">'; }
		else if(x==1) {results+='<img width=11 src="icons/1.svg">'; }
		else if(x==2) {results+='<img width=12 src="icons/2.svg">'; }
		else if(x==3) {results+='<img width=13 src="icons/3.svg">'; }
		else if(x==4) {results+='<img width=14 src="icons/4.svg">'; }
		else if(x==5) {results+='<img width=15 src="icons/5.svg">'; }
		else if(x==6) {results+='<img width=16 src="icons/6.svg">'; }
		else if(x==7) {results+='<img width=17 src="icons/7.svg">'; }
		else if(x==8) {results+='<img width=18 src="icons/8.svg">'; }
		else if(x==9) {results+='<img width=19 src="icons/9.svg">'; }
		else if(x==10) {results+='<img width=20 src="icons/10.svg">'; }
		else if(x==11) {results+='<img width=21 src="icons/11.svg">'; }
		else if(x==12) {results+='<img width=22 src="icons/12.svg">'; }
		else if(x==13) {results+='<img width=23 src="icons/13.svg">'; }
		else if(x==14) {results+='<img width=24 src="icons/14.svg">'; }
		else if(x==15) {results+='<img width=25 src="icons/15.svg">'; }

	return results;
	
	}


	function update(){

//		newpack.sort((a, b) => a[0][0], b[0][0]);
		newpack.sort((a, b) => rtest(a, b));
		
		var packdisplay = "";
		var mana = 0;
		for (let i = 0; i < newpack.length; i++) {
			mana = Math.floor((newpack[i][0][4]+newpack[i][1][4])/2);
			packdisplay += iget(newpack[i][1])+mget(mana)+' '+newpack[i][0][0]+' '+newpack[i][1][0]+' ('+newpack[i][1][1]+' '+newpack[i][1][2]+', '+newpack[i][1][3]+') '+mana+' mana<br>';
			}
		document.getElementById('content').innerHTML = `${packdisplay}`;
	}
		
	function hookup(){
		var newcard = [newData1[counter], newData2[counter]];
		var logtext = '';
		if(newData2[counter][3]=='Common') { logtext = 'Meh. Drew a '+newcard[0][0]+' '+newcard[1][0]+'.<br>'; }
		if(newData2[counter][3]=='Uncommon') { logtext = 'Not bad! Drew a '+newcard[0][0]+' '+newcard[1][0]+'.<br>'; }
		if(newData2[counter][3]=='Rare') { logtext = 'Hot damn, a '+newcard[0][0]+' '+newcard[1][0]+'!<br>'; }
		if(newData2[counter][3]=='Mythical') { logtext = 'Holy shit! A '+newcard[0][0]+' '+newcard[1][0]+'?!<br>'; }		

		document.getElementById('logged').innerHTML += logtext;
		newpack.push(newcard);
		console.log(newpack);
		update();
		counter++;
	}

	function crunked(){
		for (let i = 0; i < 10; i++) {
			hookup();
			}
	}


</script>

</body>

</html>